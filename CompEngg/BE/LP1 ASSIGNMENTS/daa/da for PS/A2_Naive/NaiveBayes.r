#....................part 1................................
#prog2 : using diabetes data with naive bayes


library("e1071")
library("caTools")
#import dataset

mydata<-read.csv(file="PimaIndiansDiabetes.csv",header=TRUE)
data(PimaIndiansDiabetes)
View(mydata)

temp_field<-sample.split(mydata,SplitRatio=0.7)
traindata<-subset(mydata, temp_field==TRUE)
testdata<-subset(mydata, temp_field==FALSE)

traindata
testdata

#.........part 2............................

my_model<-naiveBayes(as.factor(traindata$Class)~.,traindata)
my_model

#.........part 3............................
#predicting, try putting type="class" or type="raw" after the test data
pred1<-predict(my_model,testdata[,-9])
pred1

#generate the confusion matrix
table(pred1, testdata$Class, dnn=c("predicted", "Actual"))

#To save the prediction
output<-cbind(testdata, pred1)
View(output)



#output



> library("e1071")
> library("caTools")
> mydata<-read.csv(file="PimaIndiansDiabetes.csv",header=TRUE)
> data(PimaIndiansDiabetes)
Warning message:
In data(PimaIndiansDiabetes) : data set ‘PimaIndiansDiabetes’ not found
> View(mydata)
> temp_field<-sample.split(mydata,SplitRatio=0.7)
> traindata<-subset(mydata, temp_field==TRUE)
> testdata<-subset(mydata, temp_field==FALSE)
> traindata
    TimesPregnant GlucoseConcentration BloodPrs SkinThickness Serum  BMI DiabetesFunct Age
1               6                  148       72            35     0 33.6         0.627  50
2               1                   85       66            29     0 26.6         0.351  31
3               8                  183       64             0     0 23.3         0.672  32
4               1                   89       66            23    94 28.1         0.167  21
5               0                  137       40            35   168 43.1         2.288  33
6               5                  116       74             0     0 25.6         0.201  30
10              8                  125       96             0     0  0.0         0.232  54
11              4                  110       92             0     0 37.6         0.191  30
12             10                  168       74             0     0 38.0         0.537  34
13             10                  139       80             0     0 27.1         1.441  57
14              1                  189       60            23   846 30.1         0.398  59
15              5                  166       72            19   175 25.8         0.587  51
19              1                  103       30            38    83 43.3         0.183  33
20              1                  115       70            30    96 34.6         0.529  32
21              3                  126       88            41   235 39.3         0.704  27
22              8                   99       84             0     0 35.4         0.388  50
23              7                  196       90             0     0 39.8         0.451  41
24              9                  119       80            35     0 29.0         0.263  29
28              1                   97       66            15   140 23.2         0.487  22
29             13                  145       82            19   110 22.2         0.245  57
30              5                  117       92             0     0 34.1         0.337  38
31              5                  109       75            26     0 36.0         0.546  60
32              3                  158       76            36   245 31.6         0.851  28
33              3                   88       58            11    54 24.8         0.267  22
37             11                  138       76             0     0 33.2         0.420  35
38              9                  102       76            37     0 32.9         0.665  46
39              2                   90       68            42     0 38.2         0.503  27
40              4                  111       72            47   207 37.1         1.390  56
41              3                  180       64            25    70 34.0         0.271  26
42              7                  133       84             0     0 40.2         0.696  37
46              0                  180       66            39     0 42.0         1.893  25
47              1                  146       56             0     0 29.7         0.564  29
48              2                   71       70            27     0 28.0         0.586  22
49              7                  103       66            32     0 39.1         0.344  31
50              7                  105        0             0     0  0.0         0.305  24
51              1                  103       80            11    82 19.4         0.491  22
55              7                  150       66            42   342 34.7         0.718  42
56              1                   73       50            10     0 23.0         0.248  21
57              7                  187       68            39   304 37.7         0.254  41
58              0                  100       88            60   110 46.8         0.962  31
59              0                  146       82             0     0 40.5         1.781  44
60              0                  105       64            41   142 41.5         0.173  22
64              2                  141       58            34   128 25.4         0.699  24
65              7                  114       66             0     0 32.8         0.258  42
66              5                   99       74            27     0 29.0         0.203  32
67              0                  109       88            30     0 32.5         0.855  38
68              2                  109       92             0     0 42.7         0.845  54
69              1                   95       66            13    38 19.6         0.334  25
73             13                  126       90             0     0 43.4         0.583  42
74              4                  129       86            20   270 35.1         0.231  23
75              1                   79       75            30     0 32.0         0.396  22
76              1                    0       48            20     0 24.7         0.140  22
77              7                   62       78             0     0 32.6         0.391  41
78              5                   95       72            33     0 37.7         0.370  27
82              2                   74        0             0     0  0.0         0.102  22
83              7                   83       78            26    71 29.3         0.767  36
84              0                  101       65            28     0 24.6         0.237  22
85              5                  137      108             0     0 48.8         0.227  37
86              2                  110       74            29   125 32.4         0.698  27
87             13                  106       72            54     0 36.6         0.178  45
91              1                   80       55             0     0 19.1         0.258  21
92              4                  123       80            15   176 32.0         0.443  34
93              7                   81       78            40    48 46.7         0.261  42
94              4                  134       72             0     0 23.8         0.277  60
95              2                  142       82            18    64 24.7         0.761  21
96              6                  144       72            27   228 33.9         0.255  40
100             1                  122       90            51   220 49.7         0.325  31
101             1                  163       72             0     0 39.0         1.222  33
102             1                  151       60             0     0 26.1         0.179  22
103             0                  125       96             0     0 22.5         0.262  21
104             1                   81       72            18    40 26.6         0.283  24
105             2                   85       65             0     0 39.6         0.930  27
109             3                   83       58            31    18 34.3         0.336  25
110             0                   95       85            25    36 37.4         0.247  24
111             3                  171       72            33   135 33.3         0.199  24
112             8                  155       62            26   495 34.0         0.543  46
113             1                   89       76            34    37 31.2         0.192  23
114             4                   76       62             0     0 34.0         0.391  25
118             5                   78       48             0     0 33.7         0.654  25
119             4                   97       60            23     0 28.2         0.443  22
120             4                   99       76            15    51 23.2         0.223  21
121             0                  162       76            56   100 53.2         0.759  25
122             6                  111       64            39     0 34.2         0.260  24
123             2                  107       74            30   100 33.6         0.404  23
127             3                  120       70            30   135 42.9         0.452  30
128             1                  118       58            36    94 33.3         0.261  23
129             1                  117       88            24   145 34.5         0.403  40
130             0                  105       84             0     0 27.9         0.741  62
131             4                  173       70            14   168 29.7         0.361  33
132             9                  122       56             0     0 33.3         1.114  33
136             2                  125       60            20   140 33.8         0.088  31
137             0                  100       70            26    50 30.8         0.597  21
138             0                   93       60            25    92 28.7         0.532  22
139             0                  129       80             0     0 31.2         0.703  29
140             5                  105       72            29   325 36.9         0.159  28
141             3                  128       78             0     0 21.1         0.268  55
145             4                  154       62            31   284 32.8         0.237  23
146             0                  102       75            23     0  0.0         0.572  21
147             9                   57       80            37     0 32.8         0.096  41
148             2                  106       64            35   119 30.5         1.400  34
149             5                  147       78             0     0 33.7         0.218  65
150             2                   90       70            17     0 27.3         0.085  22
154             1                  153       82            42   485 40.6         0.687  23
155             8                  188       78             0     0 47.9         0.137  43
156             7                  152       88            44     0 50.0         0.337  36
157             2                   99       52            15    94 24.6         0.637  21
158             1                  109       56            21   135 25.2         0.833  23
159             2                   88       74            19    53 29.0         0.229  22
163             0                  114       80            34   285 44.2         0.167  27
164             2                  100       64            23     0 29.7         0.368  21
165             0                  131       88             0     0 31.6         0.743  32
    Class
1       1
2       0
3       1
4       0
5       1
6       0
10      1
11      0
12      1
13      0
14      1
15      1
19      0
20      1
21      0
22      0
23      1
24      1
28      0
29      0
30      0
31      0
32      1
33      0
37      0
38      1
39      1
40      1
41      0
42      0
46      1
47      0
48      0
49      1
50      0
51      0
55      0
56      0
57      1
58      0
59      0
60      0
64      0
65      1
66      0
67      1
68      0
69      0
73      1
74      0
75      0
76      0
77      0
78      0
82      0
83      0
84      0
85      1
86      0
87      0
91      0
92      0
93      0
94      1
95      0
96      0
100     1
101     1
102     0
103     0
104     0
105     0
109     0
110     1
111     1
112     1
113     0
114     0
118     0
119     0
120     0
121     1
122     0
123     0
127     0
128     0
129     1
130     1
131     1
132     1
136     0
137     0
138     0
139     0
140     0
141     0
145     0
146     0
147     0
148     0
149     0
150     0
154     0
155     1
156     1
157     0
158     0
159     0
163     0
164     0
165     1
 [ reached getOption("max.print") -- omitted 402 rows ]
> testdata
    TimesPregnant GlucoseConcentration BloodPrs SkinThickness Serum  BMI DiabetesFunct Age
7               3                   78       50            32    88 31.0         0.248  26
8              10                  115        0             0     0 35.3         0.134  29
9               2                  197       70            45   543 30.5         0.158  53
16              7                  100        0             0     0 30.0         0.484  32
17              0                  118       84            47   230 45.8         0.551  31
18              7                  107       74             0     0 29.6         0.254  31
25             11                  143       94            33   146 36.6         0.254  51
26             10                  125       70            26   115 31.1         0.205  41
27              7                  147       76             0     0 39.4         0.257  43
34              6                   92       92             0     0 19.9         0.188  28
35             10                  122       78            31     0 27.6         0.512  45
36              4                  103       60            33   192 24.0         0.966  33
43              7                  106       92            18     0 22.7         0.235  48
44              9                  171      110            24   240 45.4         0.721  54
45              7                  159       64             0     0 27.4         0.294  40
52              1                  101       50            15    36 24.2         0.526  26
53              5                   88       66            21    23 24.4         0.342  30
54              8                  176       90            34   300 33.7         0.467  58
61              2                   84        0             0     0  0.0         0.304  21
62              8                  133       72             0     0 32.9         0.270  39
63              5                   44       62             0     0 25.0         0.587  36
70              4                  146       85            27   100 28.9         0.189  27
71              2                  100       66            20    90 32.9         0.867  28
72              5                  139       64            35   140 28.6         0.411  26
79              0                  131        0             0     0 43.2         0.270  26
80              2                  112       66            22     0 25.0         0.307  24
81              3                  113       44            13     0 22.4         0.140  22
88              2                  100       68            25    71 38.5         0.324  26
89             15                  136       70            32   110 37.1         0.153  43
90              1                  107       68            19     0 26.5         0.165  24
97              2                   92       62            28     0 31.6         0.130  24
98              1                   71       48            18    76 20.4         0.323  22
99              6                   93       50            30    64 28.7         0.356  23
106             1                  126       56            29   152 28.7         0.801  21
107             1                   96      122             0     0 22.4         0.207  27
108             4                  144       58            28   140 29.5         0.287  37
115             7                  160       54            32   175 30.5         0.588  39
116             4                  146       92             0     0 31.2         0.539  61
117             5                  124       74             0     0 34.0         0.220  38
124             5                  132       80             0     0 26.8         0.186  69
125             0                  113       76             0     0 33.3         0.278  23
126             1                   88       30            42    99 55.0         0.496  26
133             3                  170       64            37   225 34.5         0.356  30
134             8                   84       74            31     0 38.3         0.457  39
135             2                   96       68            13    49 21.1         0.647  26
142             5                  106       82            30     0 39.5         0.286  38
143             2                  108       52            26    63 32.5         0.318  22
144            10                  108       66             0     0 32.4         0.272  42
151             1                  136       74            50   204 37.4         0.399  24
152             4                  114       65             0     0 21.9         0.432  37
153             9                  156       86            28   155 34.3         1.189  42
160            17                  163       72            41   114 40.9         0.817  47
161             4                  151       90            38     0 29.7         0.294  36
162             7                  102       74            40   105 37.2         0.204  45
169             4                  110       66             0     0 31.9         0.471  29
170             3                  111       90            12    78 28.4         0.495  29
171             6                  102       82             0     0 30.8         0.180  36
178             0                  129      110            46   130 67.1         0.319  26
179             5                  143       78             0     0 45.0         0.190  47
180             5                  130       82             0     0 39.1         0.956  37
187             8                  181       68            36   495 30.1         0.615  60
188             1                  128       98            41    58 32.0         1.321  33
189             8                  109       76            39   114 27.9         0.640  31
196             5                  158       84            41   210 39.4         0.395  29
197             1                  105       58             0     0 24.3         0.187  21
198             3                  107       62            13    48 22.9         0.678  23
205             6                  103       72            32   190 37.7         0.324  55
206             5                  111       72            28     0 23.9         0.407  27
207             8                  196       76            29   280 37.5         0.605  57
214             0                  140       65            26   130 42.6         0.431  24
215             9                  112       82            32   175 34.2         0.260  36
216            12                  151       70            40   271 41.8         0.742  38
223             7                  119        0             0     0 25.2         0.209  37
224             7                  142       60            33   190 28.8         0.687  61
225             1                  100       66            15    56 23.6         0.666  26
232             6                  134       80            37   370 46.2         0.238  46
233             1                   79       80            25    37 25.4         0.583  22
234             4                  122       68             0     0 35.0         0.394  29
241             1                   91       64            24     0 29.2         0.192  21
242             4                   91       70            32    88 33.1         0.446  22
243             3                  139       54             0     0 25.6         0.402  22
250             1                  111       86            19     0 30.1         0.143  23
251             9                  106       52             0     0 31.2         0.380  42
252             2                  129       84             0     0 28.0         0.284  27
259             1                  193       50            16   375 25.9         0.655  24
260            11                  155       76            28   150 33.3         1.353  51
261             3                  191       68            15   130 30.9         0.299  34
268             2                  128       64            42     0 40.0         1.101  24
269             0                  102       52             0     0 25.1         0.078  21
270             2                  146        0             0     0 27.5         0.240  28
277             7                  106       60            24     0 26.5         0.296  29
278             0                  104       64            23   116 27.8         0.454  23
279             5                  114       74             0     0 24.9         0.744  57
286             7                  136       74            26   135 26.0         0.647  51
287             5                  155       84            44   545 38.7         0.619  34
288             1                  119       86            39   220 45.6         0.808  29
295             0                  161       50             0     0 21.9         0.254  65
296             6                  151       62            31   120 35.5         0.692  28
297             2                  146       70            38   360 28.0         0.337  29
304             5                  115       98             0     0 52.9         0.209  28
305             3                  150       76             0     0 21.0         0.207  37
306             2                  120       76            37   105 39.7         0.215  29
313             2                  155       74            17    96 26.6         0.433  27
314             3                  113       50            10    85 29.5         0.626  25
315             7                  109       80            31     0 35.9         1.127  43
322             3                  112       74            30     0 31.6         0.197  25
323             0                  124       70            20     0 27.4         0.254  36
324            13                  152       90            33    29 26.8         0.731  43
331             8                  118       72            19     0 23.1         1.476  46
332             2                   87       58            16    52 32.7         0.166  25
333             1                  180        0             0     0 43.3         0.282  41
    Class
7       1
8       0
9       1
16      1
17      1
18      1
25      1
26      1
27      1
34      0
35      0
36      0
43      0
44      1
45      0
52      0
53      0
54      1
61      0
62      1
63      0
70      0
71      1
72      0
79      1
80      0
81      0
88      0
89      1
90      0
97      0
98      0
99      0
106     0
107     0
108     0
115     1
116     1
117     1
124     0
125     1
126     1
133     1
134     0
135     0
142     0
143     0
144     1
151     0
152     0
153     1
160     1
161     0
162     0
169     0
170     0
171     1
178     1
179     0
180     1
187     1
188     1
189     1
196     1
197     0
198     1
205     0
206     0
207     1
214     1
215     1
216     1
223     0
224     0
225     0
232     1
233     0
234     0
241     0
242     0
243     1
250     0
251     0
252     0
259     0
260     1
261     0
268     0
269     0
270     1
277     1
278     0
279     0
286     0
287     0
288     1
295     0
296     0
297     1
304     1
305     0
306     0
313     1
314     0
315     1
322     1
323     1
324     1
331     0
332     0
333     1
 [ reached getOption("max.print") -- omitted 144 rows ]
> my_model<-naiveBayes(as.factor(traindata$Class)~.,traindata)
> my_model

Naive Bayes Classifier for Discrete Predictors

Call:
naiveBayes.default(x = X, y = Y, laplace = laplace)

A-priori probabilities:
Y
        0         1 
0.6588694 0.3411306 

Conditional probabilities:
   TimesPregnant
Y       [,1]     [,2]
  0 3.269231 2.996784
  1 4.731429 3.556100

   GlucoseConcentration
Y       [,1]     [,2]
  0 109.2012 27.02567
  1 145.0743 29.96473

   BloodPrs
Y       [,1]     [,2]
  0 68.14201 18.09907
  1 70.96000 20.04918

   SkinThickness
Y       [,1]     [,2]
  0 19.39349 15.05407
  1 21.02286 18.23346

   Serum
Y       [,1]     [,2]
  0 65.38166 100.0916
  1 93.81714 136.2252

   BMI
Y       [,1]     [,2]
  0 30.46391 7.850816
  1 34.77771 7.284349

   DiabetesFunct
Y        [,1]      [,2]
  0 0.4352367 0.3079955
  1 0.5692171 0.4050006

   Age
Y       [,1]     [,2]
  0 31.04438 11.41948
  1 37.06286 11.37256

> #.........part 3............................
> #predicting, try putting type="class" or type="raw" after the test data
> pred1<-predict(my_model,testdata[,-9])
> pred1
  [1] 0 1 1 0 1 0 1 0 1 0 0 0 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 1 0 0 0 0 1
 [44] 0 0 0 0 0 0 0 1 1 0 0 0 0 0 1 1 1 1 1 0 1 0 0 0 0 1 0 0 1 0 1 0 1 0 0 0 0 0 0 0 0 1 1
 [87] 1 1 0 0 0 0 0 1 1 1 1 1 1 0 0 0 0 0 1 0 0 1 1 0 1 1 0 0 0 0 0 1 1 1 0 0 0 1 0 0 0 0 0
[130] 0 1 1 0 0 1 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 1
[173] 0 0 0 0 0 0 0 1 1 0 1 0 0 0 0 0 0 0 1 0 1 0 1 0 0 1 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 1 0
[216] 1 0 1 0 1 0 0 0 1 0 1 0 0 0 1 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 0 1 0
Levels: 0 1
> #generate the confusion matrix
> table(pred1, testdata$Class, dnn=c("predicted", "Actual"))
         Actual
predicted   0   1
        0 136  42
        1  26  51
> #To save the prediction
> output<-cbind(testdata, pred1)
> View(output)
> 
